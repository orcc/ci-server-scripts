#!/bin/bash

NBARGS=1
function print_usage() {
    echo
    echo "Usage: $0 <orcc_directory>"
    echo "    <orcc_directory>           Path to the directory where orcc is cloned"
}

if [ $# -lt $NBARGS ]; then
    print_usage
    exit $E_BADARGS
fi

[ ! -d "$1" ] && echo "Missing orcc directory" && print_usage && exit $E_BADARGS
[ ! "$(ls -A $1)" ] && echo "Empty orcc directory" && print_usage && exit $E_BADARGS

ORCC_DIR=$1
CURR_DIR=${pwd}

echo "***START*** $(date -R)"

cd $ORCC_DIR/eclipse/plugins/
mvn install
rc=$?
cd $CURR_DIR

if [[ $rc -ne 0 ]] ; then
  echo 'Orcc build failed'; exit $rc
else
  echo 'Orcc successfully built';
fi

echo "***END*** $0 $(date -R)"
